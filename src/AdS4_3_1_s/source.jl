# no source
Base.@kwdef mutable struct NoSource{T} <: Source
	time :: T = 0.0
	
end

Sz(t, x, y, ::NoSource) = 1.0
Sz_x(t, x, y, ::NoSource) = 0.0
Sz_y(t, x, y, ::NoSource) = 0.0

Sz_xx(t, x, y, ::NoSource) = 0.0
Sz_yy(t, x, y, ::NoSource) = 0.0
Sz_xxx(t, x, y, ::NoSource) = 0.0
Sz_yyy(t, x, y, ::NoSource) = 0.0
Sz_xxxx(t, x, y, ::NoSource) = 0.0
Sz_yyyy(t, x, y, ::NoSource) = 0.0
Sz_xy(t, x, y, ::NoSource) = 0.0
Sz_xxy(t, x, y, ::NoSource) = 0.0
Sz_xyy(t, x, y, ::NoSource) = 0.0
Sz_xxyy(t, x, y, ::NoSource) = 0.0

Sz_t(t, x, y, ::NoSource) = 0.0
Sz_tx(t, x, y, ::NoSource) = 0.0
Sz_txx(t, x, y, ::NoSource) = 0.0
Sz_ty(t, x, y, ::NoSource) = 0.0
Sz_tyy(t, x, y, ::NoSource) = 0.0
Sz_txy(t, x, y, ::NoSource) = 0.0

Sz_tt(t, x, y, ::NoSource) = 0.0


#Gaussian source
Base.@kwdef mutable struct GaussianSource{T} <: Source
	time :: T = 0.0
	Amp :: T = 0.01
	x0 :: T = 0.0
	y0 :: T = 0.0
	sigmax :: T = 0.5
	sigmay :: T = 0.5
	t0 :: T = 10.0
	L :: T = 100.0
end

#Sz(t, x, y, GS ::GaussianSource) = 1 + (GS.GS.GS.Amp*exp(-1/2*(x - GS.GS.GS.x0)^2/GS.GS.GS.sigmax^2 - (y - GS.GS.GS.y0)^2/(2*GS.GS.GS.sigmay^2))*(1 + tanh(t - GS.GS.GS.t0)))/(2*pi*GS.GS.GS.sigmax*GS.GS.GS.sigmay)
Sz(t, x, y, GS ::GaussianSource) = (1 + (GS.Amp*MathConstants.e^(-1/2*((2*pi*x)/GS.L - GS.x0)^2/GS.sigmax^2 - ((2*pi*y)/GS.L - GS.y0)^2/(2*GS.sigmay^2))*(1 + Tanh[t - GS.t0]))/(4*pi*GS.sigmax*GS.sigmay))^(-2)

Sz_x(t, x, y, GS ::GaussianSource) = (GS.Amp*MathConstants.e^(-1/2*((2*pi*x)/GS.L - GS.x0)^2/GS.sigmax^2 - ((2*pi*y)/GS.L - GS.y0)^2/(2*GS.sigmay^2))*((2*pi*x)/GS.L - GS.x0)*(1 + Tanh[t - GS.t0]))/(GS.L*GS.sigmax^3*GS.sigmay*(1 + (GS.Amp*MathConstants.e^(-1/2*((2*pi*x)/GS.L - GS.x0)^2/GS.sigmax^2 - ((2*pi*y)/GS.L - GS.y0)^2/(2*GS.sigmay^2))*(1 + Tanh[t - GS.t0]))/(4*pi*GS.sigmax*GS.sigmay))^3)

Sz_y(t, x, y, GS ::GaussianSource) = (GS.Amp*MathConstants.e^(-1/2*((2*pi*x)/GS.L - GS.x0)^2/GS.sigmax^2 - ((2*pi*y)/GS.L - GS.y0)^2/(2*GS.sigmay^2))*((2*pi*y)/GS.L - GS.y0)*(1 + Tanh[t - GS.t0]))/(GS.L*GS.sigmax*GS.sigmay^3*(1 + (GS.Amp*MathConstants.e^(-1/2*((2*pi*x)/GS.L - GS.x0)^2/GS.sigmax^2 - ((2*pi*y)/GS.L - GS.y0)^2/(2*GS.sigmay^2))*(1 + Tanh[t - GS.t0]))/(4*pi*GS.sigmax*GS.sigmay))^3)
###############
Sz_xx(t, x, y, GS ::GaussianSource) = (-128*GS.Amp*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/GS.L^2)*pi^4*GS.sigmay^2*(1 + Tanh[t - GS.t0])*(4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay*(4*pi^2*x^2 - 4*GS.L*pi*x*GS.x0 + GS.L^2*(-GS.sigmax^2 + GS.x0^2)) - GS.Amp*(8*pi^2*x^2 - 8*GS.L*pi*x*GS.x0 + GS.L^2*(GS.sigmax^2 + 2*GS.x0^2)) - GS.Amp*(8*pi^2*x^2 - 8*GS.L*pi*x*GS.x0 + GS.L^2*(GS.sigmax^2 + 2*GS.x0^2))*Tanh[t - GS.t0]))/(GS.L^4*GS.sigmax^2*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^4)

Sz_yy(t, x, y, GS ::GaussianSource) = (-128*GS.Amp*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/GS.L^2)*pi^4*GS.sigmax^2*(1 + Tanh[t - GS.t0])*(4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay*(4*pi^2*y^2 - 4*GS.L*pi*y*GS.y0 + GS.L^2*(-GS.sigmay^2 + GS.y0^2)) - GS.Amp*(8*pi^2*y^2 - 8*GS.L*pi*y*GS.y0 + GS.L^2*(GS.sigmay^2 + 2*GS.y0^2)) - GS.Amp*(8*pi^2*y^2 - 8*GS.L*pi*y*GS.y0 + GS.L^2*(GS.sigmay^2 + 2*GS.y0^2))*Tanh[t - GS.t0]))/(GS.L^4*GS.sigmay^2*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^4)

Sz_xxx(t, x, y, GS ::GaussianSource) = (512*GS.Amp*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/GS.L^2)*pi^5*GS.sigmay^2*(2*pi*x - GS.L*GS.x0)*(1 + Tanh[t - GS.t0])*(8*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/GS.L^2)*pi^2*GS.sigmax^2*GS.sigmay^2*(4*pi^2*x^2 - 4*GS.L*pi*x*GS.x0 + GS.L^2*(-3*GS.sigmax^2 + GS.x0^2)) + GS.Amp^2*(8*pi^2*x^2 - 8*GS.L*pi*x*GS.x0 + GS.L^2*(3*GS.sigmax^2 + 2*GS.x0^2)) - 2*GS.Amp*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay*(28*pi^2*x^2 - 28*GS.L*pi*x*GS.x0 + GS.L^2*(-3*GS.sigmax^2 + 7*GS.x0^2)) + 2*GS.Amp*(GS.Amp*(8*pi^2*x^2 - 8*GS.L*pi*x*GS.x0 + GS.L^2*(3*GS.sigmax^2 + 2*GS.x0^2)) - MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay*(28*pi^2*x^2 - 28*GS.L*pi*x*GS.x0 + GS.L^2*(-3*GS.sigmax^2 + 7*GS.x0^2)))*Tanh[t - GS.t0] + GS.Amp^2*(8*pi^2*x^2 - 8*GS.L*pi*x*GS.x0 + GS.L^2*(3*GS.sigmax^2 + 2*GS.x0^2))*Tanh[t - GS.t0]^2))/(GS.L^6*GS.sigmax^4*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^5)

Sz_yyy(t, x, y, GS ::GaussianSource) = (512*GS.Amp*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/GS.L^2)*pi^5*GS.sigmax^2*(2*pi*y - GS.L*GS.y0)*(1 + Tanh[t - GS.t0])*(8*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/GS.L^2)*pi^2*GS.sigmax^2*GS.sigmay^2*(4*pi^2*y^2 - 4*GS.L*pi*y*GS.y0 + GS.L^2*(-3*GS.sigmay^2 + GS.y0^2)) + GS.Amp^2*(8*pi^2*y^2 - 8*GS.L*pi*y*GS.y0 + GS.L^2*(3*GS.sigmay^2 + 2*GS.y0^2)) - 2*GS.Amp*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay*(28*pi^2*y^2 - 28*GS.L*pi*y*GS.y0 + GS.L^2*(-3*GS.sigmay^2 + 7*GS.y0^2)) + 2*GS.Amp*(GS.Amp*(8*pi^2*y^2 - 8*GS.L*pi*y*GS.y0 + GS.L^2*(3*GS.sigmay^2 + 2*GS.y0^2)) - MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay*(28*pi^2*y^2 - 28*GS.L*pi*y*GS.y0 + GS.L^2*(-3*GS.sigmay^2 + 7*GS.y0^2)))*Tanh[t - GS.t0] + GS.Amp^2*(8*pi^2*y^2 - 8*GS.L*pi*y*GS.y0 + GS.L^2*(3*GS.sigmay^2 + 2*GS.y0^2))*Tanh[t - GS.t0]^2))/(GS.L^6*GS.sigmay^4*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^5)

Sz_xxxx(t, x, y, GS ::GaussianSource) = (GS.Amp*(1 + Tanh[t - GS.t0])*(288*GS.Amp^2*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*GS.L^2*pi*GS.sigmax^3*GS.sigmay*(-2*pi*x + GS.L*GS.x0)^2*(1 + Tanh[t - GS.t0])^2 - 288*GS.Amp^2*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay*(-2*pi*x + GS.L*GS.x0)^4*(1 + Tanh[t - GS.t0])^2 + 72*GS.Amp^3*GS.L^2*GS.sigmax^2*(-2*pi*x + GS.L*GS.x0)^2*(1 + Tanh[t - GS.t0])^3 - 12*GS.Amp^3*(-2*pi*x + GS.L*GS.x0)^4*(1 + Tanh[t - GS.t0])^3 + 9*GS.Amp*GS.L^4*GS.sigmax^4*(1 + Tanh[t - GS.t0])*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^2 - 54*GS.Amp*GS.L^2*GS.sigmax^2*(-2*pi*x + GS.L*GS.x0)^2*(1 + Tanh[t - GS.t0])*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^2 + 21*GS.Amp*(-2*pi*x + GS.L*GS.x0)^4*(1 + Tanh[t - GS.t0])*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^2 - 3*GS.L^4*GS.sigmax^4*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^3 + 6*GS.L^2*GS.sigmax^2*(-2*pi*x + GS.L*GS.x0)^2*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^3 - (-2*pi*x + GS.L*GS.x0)^4*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^3))/(8*MathConstants.e^((2*((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2))/GS.L^2)*GS.L^8*GS.sigmax^12*GS.sigmay^4*(1 + (GS.Amp*(1 + Tanh[t - GS.t0]))/(4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay))^6)

Sz_yyyy(t, x, y, GS ::GaussianSource) = (GS.Amp*(1 + Tanh[t - GS.t0])*(288*GS.Amp^2*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*GS.L^2*pi*GS.sigmax*GS.sigmay^3*(-2*pi*y + GS.L*GS.y0)^2*(1 + Tanh[t - GS.t0])^2 - 288*GS.Amp^2*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay*(-2*pi*y + GS.L*GS.y0)^4*(1 + Tanh[t - GS.t0])^2 + 72*GS.Amp^3*GS.L^2*GS.sigmay^2*(-2*pi*y + GS.L*GS.y0)^2*(1 + Tanh[t - GS.t0])^3 - 12*GS.Amp^3*(-2*pi*y + GS.L*GS.y0)^4*(1 + Tanh[t - GS.t0])^3 + 9*GS.Amp*GS.L^4*GS.sigmay^4*(1 + Tanh[t - GS.t0])*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^2 - 54*GS.Amp*GS.L^2*GS.sigmay^2*(-2*pi*y + GS.L*GS.y0)^2*(1 + Tanh[t - GS.t0])*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^2 + 21*GS.Amp*(-2*pi*y + GS.L*GS.y0)^4*(1 + Tanh[t - GS.t0])*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^2 - 3*GS.L^4*GS.sigmay^4*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^3 + 6*GS.L^2*GS.sigmay^2*(-2*pi*y + GS.L*GS.y0)^2*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^3 - (-2*pi*y + GS.L*GS.y0)^4*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^3))/(8*MathConstants.e^((2*((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2))/GS.L^2)*GS.L^8*GS.sigmax^4*GS.sigmay^12*(1 + (GS.Amp*(1 + Tanh[t - GS.t0]))/(4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay))^6)

############### mixed spatial derivatives
Sz_xy(t, x, y, GS ::GaussianSource) = (-256*GS.Amp*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/GS.L^2)*pi^4*(2*pi*x - GS.L*GS.x0)*(2*pi*y - GS.L*GS.y0)*(1 + Tanh[t - GS.t0])*(-GS.Amp + 2*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay - GS.Amp*Tanh[t - GS.t0]))/(GS.L^4*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^4)

Sz_xxy(t, x, y, GS ::GaussianSource) = (512*GS.Amp*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/GS.L^2)*pi^5*(2*pi*y - GS.L*GS.y0)*(1 + Tanh[t - GS.t0])*(-2*GS.Amp*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay*(28*pi^2*x^2 - 28*GS.L*pi*x*GS.x0 - GS.L^2*(GS.sigmax^2 - 7*GS.x0^2)) + 8*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/GS.L^2)*pi^2*GS.sigmax^2*GS.sigmay^2*(4*pi^2*x^2 - 4*GS.L*pi*x*GS.x0 + GS.L^2*(-GS.sigmax^2 + GS.x0^2)) + GS.Amp^2*(8*pi^2*x^2 - 8*GS.L*pi*x*GS.x0 + GS.L^2*(GS.sigmax^2 + 2*GS.x0^2)) + 2*GS.Amp*(-(MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay*(28*pi^2*x^2 - 28*GS.L*pi*x*GS.x0 - GS.L^2*(GS.sigmax^2 - 7*GS.x0^2))) + GS.Amp*(8*pi^2*x^2 - 8*GS.L*pi*x*GS.x0 + GS.L^2*(GS.sigmax^2 + 2*GS.x0^2)))*Tanh[t - GS.t0] + GS.Amp^2*(8*pi^2*x^2 - 8*GS.L*pi*x*GS.x0 + GS.L^2*(GS.sigmax^2 + 2*GS.x0^2))*Tanh[t - GS.t0]^2))/(GS.L^6*GS.sigmax^2*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^5)

Sz_xyy(t, x, y, GS ::GaussianSource) = (512*GS.Amp*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/GS.L^2)*pi^5*(2*pi*x - GS.L*GS.x0)*(1 + Tanh[t - GS.t0])*(-2*GS.Amp*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay*(28*pi^2*y^2 - 28*GS.L*pi*y*GS.y0 - GS.L^2*(GS.sigmay^2 - 7*GS.y0^2)) + 8*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/GS.L^2)*pi^2*GS.sigmax^2*GS.sigmay^2*(4*pi^2*y^2 - 4*GS.L*pi*y*GS.y0 + GS.L^2*(-GS.sigmay^2 + GS.y0^2)) + GS.Amp^2*(8*pi^2*y^2 - 8*GS.L*pi*y*GS.y0 + GS.L^2*(GS.sigmay^2 + 2*GS.y0^2)) + 2*GS.Amp*(-(MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay*(28*pi^2*y^2 - 28*GS.L*pi*y*GS.y0 - GS.L^2*(GS.sigmay^2 - 7*GS.y0^2))) + GS.Amp*(8*pi^2*y^2 - 8*GS.L*pi*y*GS.y0 + GS.L^2*(GS.sigmay^2 + 2*GS.y0^2)))*Tanh[t - GS.t0] + GS.Amp^2*(8*pi^2*y^2 - 8*GS.L*pi*y*GS.y0 + GS.L^2*(GS.sigmay^2 + 2*GS.y0^2))*Tanh[t - GS.t0]^2))/(GS.L^6*GS.sigmay^2*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^5)

Sz_xxyy(t, x, y, GS ::GaussianSource) = (-512*GS.Amp*pi^6*(1 + Tanh[t - GS.t0])*((6*GS.Amp*GS.L^2*GS.sigmax^2*(-2*pi*y + GS.L*GS.y0)^2*(1 + Tanh[t - GS.t0])*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^2)/MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2)) - (6*GS.Amp*(-2*pi*x + GS.L*GS.x0)^2*(-2*pi*y + GS.L*GS.y0)^2*(1 + Tanh[t - GS.t0])*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^2)/MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2)) - (6*GS.Amp*(-2*pi*x + GS.L*GS.x0)^2*(8*pi^2*y^2 - 8*GS.L*pi*y*GS.y0 - GS.L^2*(GS.sigmay^2 - 2*GS.y0^2))*(1 + Tanh[t - GS.t0])*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^2)/MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2)) + (GS.L^2*GS.sigmax^2*(-4*pi^2*y^2 + 4*GS.L*pi*y*GS.y0 + GS.L^2*(GS.sigmay^2 - GS.y0^2))*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^3)/MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2)) + ((-2*pi*x + GS.L*GS.x0)^2*(4*pi^2*y^2 - 4*GS.L*pi*y*GS.y0 + GS.L^2*(-GS.sigmay^2 + GS.y0^2))*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^3)/MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2)) - (3*GS.Amp*GS.L^2*GS.sigmax^2*(1 + Tanh[t - GS.t0])*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])*(-4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay*(4*pi^2*y^2 - 4*GS.L*pi*y*GS.y0 + GS.L^2*(-GS.sigmay^2 + GS.y0^2)) + GS.Amp*(12*pi^2*y^2 - 12*GS.L*pi*y*GS.y0 + GS.L^2*(GS.sigmay^2 + 3*GS.y0^2)) + GS.Amp*(12*pi^2*y^2 - 12*GS.L*pi*y*GS.y0 + GS.L^2*(GS.sigmay^2 + 3*GS.y0^2))*Tanh[t - GS.t0]))/MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2)) + (3*GS.Amp*(-2*pi*x + GS.L*GS.x0)^2*(1 + Tanh[t - GS.t0])*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])*(-4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay*(4*pi^2*y^2 - 4*GS.L*pi*y*GS.y0 + GS.L^2*(-GS.sigmay^2 + GS.y0^2)) + GS.Amp*(12*pi^2*y^2 - 12*GS.L*pi*y*GS.y0 + GS.L^2*(GS.sigmay^2 + 3*GS.y0^2)) + GS.Amp*(12*pi^2*y^2 - 12*GS.L*pi*y*GS.y0 + GS.L^2*(GS.sigmay^2 + 3*GS.y0^2))*Tanh[t - GS.t0]))/MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2)) - (12*GS.Amp^2*(-2*pi*x + GS.L*GS.x0)^2*(1 + Tanh[t - GS.t0])^2*(-4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay*(4*pi^2*y^2 - 4*GS.L*pi*y*GS.y0 + GS.L^2*(-GS.sigmay^2 + GS.y0^2)) + GS.Amp*(16*pi^2*y^2 - 16*GS.L*pi*y*GS.y0 + GS.L^2*(GS.sigmay^2 + 4*GS.y0^2)) + GS.Amp*(16*pi^2*y^2 - 16*GS.L*pi*y*GS.y0 + GS.L^2*(GS.sigmay^2 + 4*GS.y0^2))*Tanh[t - GS.t0]))/MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2)) + 48*GS.Amp^2*(-2*pi*x + GS.L*GS.x0)^2*(-2*pi*y + GS.L*GS.y0)^2*(1 + Tanh[t - GS.t0])^2*(4*pi*GS.sigmax*GS.sigmay + (GS.Amp*(1 + Tanh[t - GS.t0]))/MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2)))))/(MathConstants.e^((3*((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2))/(2*GS.L^2))*GS.L^8*GS.sigmax^2*GS.sigmay^2*(4*pi*GS.sigmax*GS.sigmay + (GS.Amp*(1 + Tanh[t - GS.t0]))/MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2)))^6)
###############
Sz_t(t, x, y, GS ::GaussianSource) = (-32*GS.Amp*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/GS.L^2)*pi^2*GS.sigmax^2*GS.sigmay^2*Sech[t - GS.t0]^2)/(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^3

Sz_tx(t, x, y, GS ::GaussianSource) = (128*GS.Amp*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/GS.L^2)*pi^3*GS.sigmay^2*(2*pi*x - GS.L*GS.x0)*Sech[t - GS.t0]^2*(-GS.Amp + 2*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay - GS.Amp*Tanh[t - GS.t0]))/(GS.L^2*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^4)

Sz_txx(t, x, y, GS ::GaussianSource) = (-256*GS.Amp*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/GS.L^2)*pi^4*GS.sigmay^2*Sech[t - GS.t0]^2*(-2*GS.Amp*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay*(28*pi^2*x^2 - 28*GS.L*pi*x*GS.x0 - GS.L^2*(GS.sigmax^2 - 7*GS.x0^2)) + 8*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/GS.L^2)*pi^2*GS.sigmax^2*GS.sigmay^2*(4*pi^2*x^2 - 4*GS.L*pi*x*GS.x0 + GS.L^2*(-GS.sigmax^2 + GS.x0^2)) + GS.Amp^2*(8*pi^2*x^2 - 8*GS.L*pi*x*GS.x0 + GS.L^2*(GS.sigmax^2 + 2*GS.x0^2)) + 2*GS.Amp*(-(MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay*(28*pi^2*x^2 - 28*GS.L*pi*x*GS.x0 - GS.L^2*(GS.sigmax^2 - 7*GS.x0^2))) + GS.Amp*(8*pi^2*x^2 - 8*GS.L*pi*x*GS.x0 + GS.L^2*(GS.sigmax^2 + 2*GS.x0^2)))*Tanh[t - GS.t0] + GS.Amp^2*(8*pi^2*x^2 - 8*GS.L*pi*x*GS.x0 + GS.L^2*(GS.sigmax^2 + 2*GS.x0^2))*Tanh[t - GS.t0]^2))/(GS.L^4*GS.sigmax^2*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^5)

Sz_ty(t, x, y, GS ::GaussianSource) = (128*GS.Amp*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/GS.L^2)*pi^3*GS.sigmax^2*(2*pi*y - GS.L*GS.y0)*Sech[t - GS.t0]^2*(-GS.Amp + 2*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay - GS.Amp*Tanh[t - GS.t0]))/(GS.L^2*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^4)

Sz_tyy(t, x, y, GS ::GaussianSource) = (-256*GS.Amp*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/GS.L^2)*pi^4*GS.sigmax^2*Sech[t - GS.t0]^2*(-2*GS.Amp*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay*(28*pi^2*y^2 - 28*GS.L*pi*y*GS.y0 - GS.L^2*(GS.sigmay^2 - 7*GS.y0^2)) + 8*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/GS.L^2)*pi^2*GS.sigmax^2*GS.sigmay^2*(4*pi^2*y^2 - 4*GS.L*pi*y*GS.y0 + GS.L^2*(-GS.sigmay^2 + GS.y0^2)) + GS.Amp^2*(8*pi^2*y^2 - 8*GS.L*pi*y*GS.y0 + GS.L^2*(GS.sigmay^2 + 2*GS.y0^2)) + 2*GS.Amp*(-(MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay*(28*pi^2*y^2 - 28*GS.L*pi*y*GS.y0 - GS.L^2*(GS.sigmay^2 - 7*GS.y0^2))) + GS.Amp*(8*pi^2*y^2 - 8*GS.L*pi*y*GS.y0 + GS.L^2*(GS.sigmay^2 + 2*GS.y0^2)))*Tanh[t - GS.t0] + GS.Amp^2*(8*pi^2*y^2 - 8*GS.L*pi*y*GS.y0 + GS.L^2*(GS.sigmay^2 + 2*GS.y0^2))*Tanh[t - GS.t0]^2))/(GS.L^4*GS.sigmay^2*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^5)

Sz_txy(t, x, y, GS ::GaussianSource) = (-512*GS.Amp*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/GS.L^2)*pi^4*(2*pi*x - GS.L*GS.x0)*(2*pi*y - GS.L*GS.y0)*Sech[t - GS.t0]^2*(GS.Amp^2 - 7*GS.Amp*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/GS.L^2)*pi^2*GS.sigmax^2*GS.sigmay^2 + GS.Amp*(2*GS.Amp - 7*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay)*Tanh[t - GS.t0] + GS.Amp^2*Tanh[t - GS.t0]^2))/(GS.L^4*(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^5)

Sz_tt(t, x, y, GS ::GaussianSource) = (32*GS.Amp*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/GS.L^2)*pi^2*GS.sigmax^2*GS.sigmay^2*Sech[t - GS.t0]^4*(2*GS.Amp + GS.Amp*Cosh[2*(t - GS.t0)] + (GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay)*Sinh[2*(t - GS.t0)]))/(GS.Amp + 4*MathConstants.e^(((-2*pi*x + GS.L*GS.x0)^2/GS.sigmax^2 + (-2*pi*y + GS.L*GS.y0)^2/GS.sigmay^2)/(2*GS.L^2))*pi*GS.sigmax*GS.sigmay + GS.Amp*Tanh[t - GS.t0])^4



@inline getSourcetime(ff::Source) = ff.time


